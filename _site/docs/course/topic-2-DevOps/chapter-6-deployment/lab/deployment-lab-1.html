<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

.site-nav > ul.nav-list:first-child > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(2)) > a {
  background-image: none;
}

.site-nav > ul.nav-list:not(:first-child) a,
.site-nav li.external a {
  background-image: none;
}

.site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(6) > ul > li:nth-child(2) > a {
  font-weight: 600;
  text-decoration: none;
}.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg,
.site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(6) > button svg {
  transform: rotate(-90deg);
}.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list,
.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(6) > ul.nav-list {
  display: block;
}
  </style>

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/assets/images/opendevsecops-favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Lab 1. Configuring a Simple CI/CD Pipeline | open-devsecops</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Lab 1. Configuring a Simple CI/CD Pipeline" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="From Classroom to Industry: Bridging the DevSecOps Knowledge Gap with Open, Practical Learning." />
<meta property="og:description" content="From Classroom to Industry: Bridging the DevSecOps Knowledge Gap with Open, Practical Learning." />
<link rel="canonical" href="http://localhost:4000/docs/course/topic-2-DevOps/chapter-6-deployment/lab/deployment-lab-1.html" />
<meta property="og:url" content="http://localhost:4000/docs/course/topic-2-DevOps/chapter-6-deployment/lab/deployment-lab-1.html" />
<meta property="og:site_name" content="open-devsecops" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lab 1. Configuring a Simple CI/CD Pipeline" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"From Classroom to Industry: Bridging the DevSecOps Knowledge Gap with Open, Practical Learning.","headline":"Lab 1. Configuring a Simple CI/CD Pipeline","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/opendevsecops-transparent.png"}},"url":"http://localhost:4000/docs/course/topic-2-DevOps/chapter-6-deployment/lab/deployment-lab-1.html"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.25.0/tocbot.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.25.0/tocbot.min.js"></script>
<meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="expires" content="0">

</head>

<body>
  <div id="progress-container">
    <div id="progress-bar"></div>
    <span id="progress-text">0%</span>
</div>

  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="master-container">
    <div class="main-container">
      <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/" class="site-title lh-tight"><div class="site-nav-header">
    <div class="site-logo" role="img" aria-label="open-devsecops"></div>
    <p>open-devsecops</p]>
</div></a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Dashboard</a></li><li class="nav-list-item"><a href="/docs/Community%20Hub/" class="nav-list-link">Community Hub</a></li><li class="nav-list-item"><a href="/docs/course/" class="nav-list-link">Course Overview</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Lab Infrastructure Setup Guide category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/docs/lab-setup-guide/" class="nav-list-link">Lab Infrastructure Setup Guide</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topic 2 - DevOps category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/lab-setup-guide/topic-2-devops-lab/" class="nav-list-link">Topic 2 - DevOps</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/lab-setup-guide/topic-2-devops-lab/aws/" class="nav-list-link">AWS</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topic 3 - DevSecOps category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/lab-setup-guide/topic-3-devsecops-lab/" class="nav-list-link">Topic 3 - DevSecOps</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/lab-setup-guide/topic-3-devsecops-lab/aws/" class="nav-list-link">AWS</a>
              </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topic 1 - Git category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/docs/course/topic-1-git/" class="nav-list-link">Topic 1 - Git</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/course/topic-1-git/chapter-1-version-control/" class="nav-list-link">Chapter 1 - Introduction to Version Control</a></li><li class="nav-list-item"><a href="/docs/course/topic-1-git/chapter-2-understanding-git/" class="nav-list-link">Chapter 2 - Git Fundamentals</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Chapter 3 - Git Intermediate Concepts category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/course/topic-1-git/chapter-3-Intermediate-Concepts/" class="nav-list-link">Chapter 3 - Git Intermediate Concepts</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/course/topic-1-git/chapter-3-Intermediate-Concepts/lab/git-lab-1.html" class="nav-list-link">Lab 1. Version Control and Branching</a>
              </li></ul></li><li class="nav-list-item"><a href="/docs/course/topic-1-git/chapter-4-git-best-practices/" class="nav-list-link">Chapter 4 - Git Best Practices</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topic 2 - DevOps category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/docs/course/topic-2-DevOps/" class="nav-list-link">Topic 2 - DevOps</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/course/topic-2-DevOps/chapter-1-intro-to-devops/" class="nav-list-link">Chapter 1 - Intro to DevOps</a></li><li class="nav-list-item"><a href="/docs/course/topic-2-DevOps/chapter-2-intro-to-ci-cd/" class="nav-list-link">Chapter 2 - Intro to CI/CD</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Chapter 3 - Containerization category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/course/topic-2-DevOps/chapter-3-containerization/" class="nav-list-link">Chapter 3 - Containerization</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/course/topic-2-DevOps/chapter-3-containerization/lab/overview.html" class="nav-list-link">Labs Overview</a>
              </li><li class="nav-list-item">
                <a href="/docs/course/topic-2-DevOps/chapter-3-containerization/lab/containerization-lab-1.html" class="nav-list-link">Lab 1. Containerizing a React Application</a>
              </li><li class="nav-list-item">
                <a href="/docs/course/topic-2-DevOps/chapter-3-containerization/lab/containerization-lab-2.html" class="nav-list-link">Lab 2. Accessing Corporate Network and AWS ECR</a>
              </li></ul></li><li class="nav-list-item"><a href="/docs/course/topic-2-DevOps/chapter-4-webhooks/" class="nav-list-link">Chapter 4 - Webhooks</a></li><li class="nav-list-item"><a href="/docs/course/topic-2-DevOps/chapter-5-automation/" class="nav-list-link">Chapter 5 - Automated Tests</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Chapter 6 - Deployment category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/course/topic-2-DevOps/chapter-6-deployment/" class="nav-list-link">Chapter 6 - Deployment</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/course/topic-2-DevOps/chapter-6-deployment/lab/overview.html" class="nav-list-link">Labs Overview</a>
              </li><li class="nav-list-item">
                <a href="/docs/course/topic-2-DevOps/chapter-6-deployment/lab/deployment-lab-1.html" class="nav-list-link">Lab 1. Configuring a Simple CI/CD Pipeline</a>
              </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topic 3 - DevSecOps category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/docs/course/topic-3-devsecops/" class="nav-list-link">Topic 3 - DevSecOps</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/course/topic-3-devsecops/chapter-1-devsecops/" class="nav-list-link">Chapter 1 - DevSecOps</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Chapter 2 - Security Checks in CI/CD category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/course/topic-3-devsecops/chapter-2-security-checks-in-CICD/" class="nav-list-link">Chapter 2 - Security Checks in CI/CD</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/course/topic-3-devsecops/chapter-2-security-checks-in-CICD/lab/overview.html" class="nav-list-link">Labs Overview</a>
              </li><li class="nav-list-item">
                <a href="/docs/course/topic-3-devsecops/chapter-2-security-checks-in-CICD/lab/devsecops-lab-1.html" class="nav-list-link">Lab 1. Securing a Vulnerable Application</a>
              </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Other Documents category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/docs/other/" class="nav-list-link">Other Documents</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/other/research/references.html" class="nav-list-link">References</a></li><li class="nav-list-item"><a href="/docs/other/research/user-research.html" class="nav-list-link">User Research</a></li></ul></li></ul>

  
</nav>


  
  
    <footer class="site-footer">
    This site uses a custom theme based on <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>.
</footer>
  
</div>

      <div class="content-container">
        <div class="main" id="top">
          <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search the documentation..." aria-label="Search the documentation..." autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/open-devsecops" class="site-button"
          
        >
          Github
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/open-devsecops/open-devsecops.github.io" class="site-button"
          
        >
          Contribute
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

            <div class="main-content-wrap">
              <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
    <li class="breadcrumb-nav-list-item"><a href="/docs/course/topic-2-DevOps/">Topic 2 - DevOps</a></li>
    <li class="breadcrumb-nav-list-item"><a href="/docs/course/topic-2-DevOps/chapter-6-deployment/">Chapter 6 - Deployment</a></li>
    <li class="breadcrumb-nav-list-item"><span>Lab 1. Configuring a Simple CI/CD Pipeline</span></li>
  </ol>
</nav>
              <div id="main-content" class="main-content">
                <main>
                  






<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->
<p class="label label-blue"><strong>Estimated Time to Complete:</strong> 60 minutes</p>

<p class="info">Before you begin the lab exercise, please check the <strong>Labs Overview</strong> page to ensure that you have all the required software installed and that you meet all the prerequisites.</p>

<h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>In this lab, you will automate the process of building, and deploying a Dockerized application using Jenkins. Building upon the manual processes you learned in Chapter 3, you will create a very simple Jenkins pipeline that automates these tasks.</p>

<p>This exercise aims to demystify the CI/CD process, helping you better visualize the workflow from building an application to its deployment. <strong>It’s important to note that CI/CD pipelines in real-world scenarios involve more complexity and other CI/CD tools might use different syntax for defining pipelines.</strong> However, understanding this basic structure will equip you with the fundamental knowledge required to grasp more complex workflows in the industry.</p>

<h2 id="accessing-the-corporate-network-via-vpn"><span class="me-2">Accessing the Corporate Network via VPN</span><a href="#accessing-the-corporate-network-via-vpn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p class="warning">This lab requires the lab infrastructure to be set up by an instructor or administrator. Independent learners should refer to the <a href="../../../../lab-setup-guide/">lab setup repository</a> to configure this environment accordingly.</p>

<p><strong>VPN Configuration and Connection:</strong></p>
<ul>
  <li>Download the VPN configuration file from <code class="language-plaintext highlighter-rouge">https://{public_ip}</code>. <em>Ask the lab administrator for the public ip of the internal network, and replace the <code class="language-plaintext highlighter-rouge">{public_ip}</code> placeholder.</em></li>
</ul>

<p class="info">When you access the website using the public IP, you may encounter a security warning in your browser that states <strong>Your connection is not private</strong>. This warning appears because the site is using a <strong>self-signed SSL certificate</strong> rather than one issued by a recognized Certificate Authority. They offer the same level of encryption but are not verified by a third-party authority that your browser trusts by default (<a href="https://en.wikipedia.org/wiki/Self-signed_certificate">Learn more here</a>). Click on “Advanced” or “Show Details” and proceed to the website (The exact wording may vary depending on your browser).</p>

<ul>
  <li>Import the VPN configuration file into the Wireguard Client to establish the VPN connection. This step provides access to internal services.
<img src="./imgs/wireguard.png" alt="wireguard interface" /></li>
</ul>

<h2 id="accessing-jenkins"><span class="me-2">Accessing Jenkins</span><a href="#accessing-jenkins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Once you’re connected to the VPN, navigate to <code class="language-plaintext highlighter-rouge">http://jenkins.internal</code> in your browser to access the Jenkins dashboard. <em>Ask the lab administrator for the credentials for jenkins.</em> 
<img src="./imgs/jenkins-login.png" alt="jenkins main interface" /></p>

<h2 id="creating-a-pipeline-in-jenkins"><span class="me-2">Creating a Pipeline in Jenkins</span><a href="#creating-a-pipeline-in-jenkins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>Create a New Item: From the Jenkins dashboard, select “New Item” at the top left.</li>
  <li>Name Your Pipeline: Enter a name for your project, and select “Pipeline” as the type.</li>
</ul>

<p><strong>Configure the Pipeline:</strong></p>

<p>In the General section, choose “GitHub project” and enter the GitHub repository URL.</p>
<ul>
  <li>If you haven’t already from the previous lab, fork the reference application repository and enter the forked repo URL.</li>
</ul>

<p>In the Pipeline section, choose “Pipeline script from SCM” for the Definition.</p>
<ul>
  <li>Select “Git” as the SCM.</li>
  <li>Enter the repository URL of your forked version of the reference application.</li>
  <li>Change Branch Specifier from <code class="language-plaintext highlighter-rouge">*/master</code> to <code class="language-plaintext highlighter-rouge">*/main</code>.</li>
</ul>

<p>Click <code class="language-plaintext highlighter-rouge">apply</code> and <code class="language-plaintext highlighter-rouge">save</code>.</p>

<h2 id="setting-up-webhooks"><span class="me-2">Setting Up Webhooks</span><a href="#setting-up-webhooks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Webhooks allow GitHub to notify Jenkins about code changes, triggering the pipeline we have created.</p>

<p><strong>Configure Webhooks:</strong></p>
<ul>
  <li>Go to your forked repository on GitHub, navigate to “Settings” &gt; “Webhooks” &gt; “Add webhook.”</li>
  <li>Enter the URL provided on the <code class="language-plaintext highlighter-rouge">http://dashboard.internal</code> page into the Payload URL in GitHub Webhooks creation page.</li>
  <li>Select <code class="language-plaintext highlighter-rouge">application/json</code> as the Content Type.</li>
  <li>Save your webhook. This setup ensures Jenkins is notified on every code push, automating the build process.</li>
</ul>

<h2 id="creating-the-jenkinsfile"><span class="me-2">Creating the Jenkinsfile</span><a href="#creating-the-jenkinsfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>We’re now going to create a Jenkinsfile.</p>

<p>Written in Groovy, Jenkinsfile provides a declarative way to to define our CI/CD Pipeline, automating the steps we manually performed in Chapter 1.</p>

<p><strong>Declarative Pipeline Syntax</strong></p>

<p>Jenkinsfiles typically use a declarative syntax that outlines the pipeline in sections like <code class="language-plaintext highlighter-rouge">pipeline</code>, <code class="language-plaintext highlighter-rouge">agent</code>, <code class="language-plaintext highlighter-rouge">stages</code>, <code class="language-plaintext highlighter-rouge">stage</code>, and <code class="language-plaintext highlighter-rouge">steps</code> <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#declarative-sections">More Information can be found in Jenkin’s Documentation</a>.</p>

<p><strong>Pipeline and Agent</strong></p>

<p>All declarative pipelines are enclosed within a pipeline block. <code class="language-plaintext highlighter-rouge">agent</code> specifies where this pipeline will be executed. Let’s keep this simple and tell Jenkins that it can use any available agent to run the pipeline.</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">pipeline</span> <span class="o">{</span>
    <span class="n">agent</span> <span class="n">any</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Stages</strong></p>

<p>Now, we’re going to use <code class="language-plaintext highlighter-rouge">stages</code> to include a sequence of one or more <code class="language-plaintext highlighter-rouge">stage</code> directives to define what work will be done in the pipeline.</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">pipeline</span> <span class="o">{</span>
    <span class="n">agent</span> <span class="n">any</span>

    <span class="n">stages</span> <span class="o">{</span>
        <span class="c1">// each stage goes in this block</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Stage 1: Checkout</strong></p>

<p>In this stage, we will tell Jenkins to grab the latest version of our code from the repository we specified earlier in the Jenkins UI.</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">stage</span><span class="o">(</span><span class="s1">'Checkout'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">checkout</span> <span class="n">scm</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Stage 2: Build</strong></p>

<p>Now that Jenkins has the codebase with the Dockerfile, we’re going to ask it to build a Docker image. The <code class="language-plaintext highlighter-rouge">sh</code> is our way of telling Jenkins to execute the specified <em>shell</em> command.</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">stage</span><span class="o">(</span><span class="s1">'Build'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">sh</span> <span class="s1">'docker build . -t $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">&lt;image-name&gt;</code> is where you specify your container image name.</li>
</ul>

<blockquote class="info">
  <p>Remember how in <a href="https://github.com/open-devsecops/course/blob/master/topic-2-cicd/chapter-1-containerization/lab/lab1.md#building-your-docker-image">Chapter 1</a>, we used the Docker CLI to build our image manually? This command is essentially automating that process.</p>
</blockquote>

<p><strong>Stage 3: Push Image</strong></p>

<p>With our Docker image built, it’s time to push the image to a shared registry.</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">stage</span><span class="o">(</span><span class="s1">'Push Image'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">steps</span> <span class="o">{</span>
        <span class="n">sh</span> <span class="s1">'aws ecr get-login-password --region $REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com'</span>
        <span class="n">sh</span> <span class="s1">'aws ecr describe-repositories --repository-names &lt;image-name&gt; || aws ecr create-repository --repository-name &lt;image-name&gt;'</span>
        <span class="n">sh</span> <span class="s1">'docker push $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In the second shell command, we check whether the specified AWS ECR repository already exists. If it doesn’t, we automatically create it using <code class="language-plaintext highlighter-rouge">aws ecr create-repository</code>.</p>

<blockquote class="info">
  <p>Using a shared registry is crucial because the image we’ve built needs to be accessible across different stages of the pipeline and potentially by different agents or nodes that might run these stages. These agents could be spread across various environments in the Cloud.</p>
</blockquote>

<p><strong>Stage 4: Deploy</strong></p>

<p>Finally, we reach the deploy stage. This is where we take our Docker image and run it, making our application live and accessible to the world!</p>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">stage</span><span class="o">(</span><span class="s1">'Deploy'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">steps</span> <span class="o">{</span>
        <span class="n">sh</span> <span class="s1">'docker pull $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
        <span class="n">sh</span> <span class="s1">'docker rm -f &lt;container-name&gt; || true'</span>
        <span class="n">sh</span> <span class="s1">'docker run -d -p "&lt;host-port&gt;:80" --name &lt;container-name&gt; $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">&lt;container-name&gt;</code> is where you specify the name for your running container.</li>
  <li>The <code class="language-plaintext highlighter-rouge">&lt;host-port&gt;</code> is where you specify the port on the host machine, which is used to forward traffic to port 80 of the running container.</li>
</ul>

<blockquote class="warning">
  <p>When specifying <code class="language-plaintext highlighter-rouge">&lt;host-port&gt;</code>, please choose a port number between 2000 and 3000 unless specified otherwise by your administrator. This range is allowed through the firewall, ensuring your deployed application is accessible on the Internet.</p>
</blockquote>

<blockquote class="info">
  <p>Think back to when you built, pushed, pulled, and ran your container locally in Chapter 3. Now, we’ve automated this step to occur in a potentially different environment, demonstrating the power of CI/CD.</p>
</blockquote>

<h3 id="the-complete-jenkinsfile"><span class="me-2">The Complete Jenkinsfile</span><a href="#the-complete-jenkinsfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-groovy highlighter-rouge"><div class="code-header">
        <span data-label-text="Groovy"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code><span class="n">pipeline</span> <span class="o">{</span>
    <span class="n">agent</span> <span class="n">any</span>
    
    <span class="n">stages</span> <span class="o">{</span>
        <span class="n">stage</span><span class="o">(</span><span class="s1">'Checkout'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">steps</span> <span class="o">{</span>
                <span class="n">checkout</span> <span class="n">scm</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">stage</span><span class="o">(</span><span class="s1">'Build'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">steps</span> <span class="o">{</span>
                <span class="n">sh</span> <span class="s1">'docker build . -t $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">stage</span><span class="o">(</span><span class="s1">'Push Image'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">steps</span> <span class="o">{</span>
                <span class="n">sh</span> <span class="s1">'aws ecr get-login-password --region $REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com'</span>
                <span class="n">sh</span> <span class="s1">'aws ecr describe-repositories --repository-names &lt;repository-name&gt; || aws ecr create-repository --repository-name &lt;repository-name&gt;'</span>
                <span class="n">sh</span> <span class="s1">'docker push $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">stage</span><span class="o">(</span><span class="s1">'Deploy'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">steps</span> <span class="o">{</span>
                <span class="n">sh</span> <span class="s1">'docker pull $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
                <span class="n">sh</span> <span class="s1">'docker rm -f &lt;container-name&gt; || true'</span>
                <span class="n">sh</span> <span class="s1">'docker run -d -p "&lt;host-port&gt;:80" --name &lt;container-name&gt; $AWS_ACCOUNT_ID.dkr.ecr.$REGION.amazonaws.com/&lt;image-name&gt;'</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="seeing-the-cicd-pipeline-in-action"><span class="me-2">Seeing the CI/CD pipeline in Action</span><a href="#seeing-the-cicd-pipeline-in-action" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>After creating the Jenkinsfile, it’s time to see the CI/CD pipeline in action!</p>

<ol>
  <li>Commit and push your Jenkinsfile if you haven’t already</li>
  <li>Make some changes to your application.</li>
  <li>Push your changes to the remote repository. This will signal Jenkins to initiate the pipeline, thanks to the webhook you’ve set up previously.</li>
  <li>Navigate to the Jenkins dashboard <code class="language-plaintext highlighter-rouge">http://jenkins.internal</code> and observe the pipeline you configured starting to run automatically.</li>
</ol>

<p>Once the pipeline completes, view you application at the following url!</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <div></div></div><div class="highlight"><pre><code>http://{public_ip}:{host_port}
</code></pre></div></div>

<p>Replace <code class="language-plaintext highlighter-rouge">{public_ip}</code> with the public IP address, and <code class="language-plaintext highlighter-rouge">{host_port}</code> with the specific port number you’ve chosen during the deployment stage in the Jenkinsfile.</p>

<p class="warning">Don’t forget to deactivate your VPN connection after you have completed the lab exercise!</p>

                  
                </main>
                

  <hr>
  <footer>
    

    <script>
    /* Dynamically add the toc navbar after the side-bar element. This allows us
        to *not* have to override default.html in _layouts */
    let sideBarElements = document.getElementsByClassName('content-container');
    let tocNav = document.createElement('nav');
    tocNav.setAttribute("id", "tocbot-toc");
    tocNav.classList.add("js-toc");
    tocNav.classList.add("tocbot-right");
    sideBarElements[0].after(tocNav);

    /** WARNING: YOU MUST USE C MULTI-LINE COMMENT STYLE RATHER THAN // BECAUSE 
     *  OF HOW JEKYLL COMPILES THIS FILE INTO SINGLE LINES **/
    tocbot.init({
        /* Where to render the table of contents. */
        tocSelector: '.js-toc',
        /* Where to grab the headings to build the table of contents. */
        contentSelector: '.main-content-wrap',
        /* How many heading levels should collapse. Default is 0 */
        collapseDepth: 2,
        /* Which headings to grab inside of the contentSelector element. */
        headingSelector: 'h2',
    });

    /* Track scrolling to show/hide the tocbot navigation bar on right side */
    var onScrollHandler = function (event) {

        /* End event listener after visitor scrolls past 500px */
        if (window.pageYOffset > 500) {
        window.removeEventListener('scroll', onScrollHandler, false);
        document.getElementById("tocbot-toc").style.visibility = "visible";
        }
        /* console.log("window scroll event:", window.pageYOffset); */
    };

    /* Listen for scroll events */
    window.addEventListener('scroll', onScrollHandler, false);
</script>
<script>
    let lists = document.getElementsByClassName('toc-list');
    if (lists.length > 0) {
        let header = document.createElement('h2');
        header.innerText = "Contents";
        lists[0].prepend(header);
    }
</script>

    
  </footer>


              </div>
          </div>
        </div>
        
          
<button id="search-button" class="search-button btn-reset" aria-label="Focus on search">
  <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-search"></use></svg>
</button>


<div class="search-overlay"></div>

        
      </div>
    </div>
  </div>

  
  <script src="/assets/js/progress.js"></script>
</body>
</html>